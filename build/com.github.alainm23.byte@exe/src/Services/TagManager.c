/* TagManager.c generated by valac 0.40.12, the Vala compiler
 * generated from TagManager.vala, do not modify */



#include <glib.h>
#include <glib-object.h>
#include <gst/pbutils/pbutils.h>
#include <stdlib.h>
#include <string.h>
#include <glib/gi18n-lib.h>
#include <gst/gst.h>


#define SERVICES_TYPE_TAG_MANAGER (services_tag_manager_get_type ())
#define SERVICES_TAG_MANAGER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SERVICES_TYPE_TAG_MANAGER, ServicesTagManager))
#define SERVICES_TAG_MANAGER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SERVICES_TYPE_TAG_MANAGER, ServicesTagManagerClass))
#define SERVICES_IS_TAG_MANAGER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SERVICES_TYPE_TAG_MANAGER))
#define SERVICES_IS_TAG_MANAGER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SERVICES_TYPE_TAG_MANAGER))
#define SERVICES_TAG_MANAGER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SERVICES_TYPE_TAG_MANAGER, ServicesTagManagerClass))

typedef struct _ServicesTagManager ServicesTagManager;
typedef struct _ServicesTagManagerClass ServicesTagManagerClass;
typedef struct _ServicesTagManagerPrivate ServicesTagManagerPrivate;
enum  {
	SERVICES_TAG_MANAGER_0_PROPERTY,
	SERVICES_TAG_MANAGER_DISCOVER_COUNTER_PROPERTY,
	SERVICES_TAG_MANAGER_NUM_PROPERTIES
};
static GParamSpec* services_tag_manager_properties[SERVICES_TAG_MANAGER_NUM_PROPERTIES];
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_free0(var) (var = (g_free (var), NULL))
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
typedef struct _Block3Data Block3Data;

#define OBJECTS_TYPE_TRACK (objects_track_get_type ())
#define OBJECTS_TRACK(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), OBJECTS_TYPE_TRACK, ObjectsTrack))
#define OBJECTS_TRACK_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), OBJECTS_TYPE_TRACK, ObjectsTrackClass))
#define OBJECTS_IS_TRACK(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), OBJECTS_TYPE_TRACK))
#define OBJECTS_IS_TRACK_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), OBJECTS_TYPE_TRACK))
#define OBJECTS_TRACK_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), OBJECTS_TYPE_TRACK, ObjectsTrackClass))

typedef struct _ObjectsTrack ObjectsTrack;
typedef struct _ObjectsTrackClass ObjectsTrackClass;
typedef struct _ObjectsTrackPrivate ObjectsTrackPrivate;

#define SERVICES_TYPE_DATABASE (services_database_get_type ())
#define SERVICES_DATABASE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SERVICES_TYPE_DATABASE, ServicesDatabase))
#define SERVICES_DATABASE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SERVICES_TYPE_DATABASE, ServicesDatabaseClass))
#define SERVICES_IS_DATABASE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SERVICES_TYPE_DATABASE))
#define SERVICES_IS_DATABASE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SERVICES_TYPE_DATABASE))
#define SERVICES_DATABASE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SERVICES_TYPE_DATABASE, ServicesDatabaseClass))

typedef struct _ServicesDatabase ServicesDatabase;
typedef struct _ServicesDatabaseClass ServicesDatabaseClass;
#define _objects_track_unref0(var) ((var == NULL) ? NULL : (var = (objects_track_unref (var), NULL)))
#define _gst_tag_list_unref0(var) ((var == NULL) ? NULL : (var = (gst_tag_list_unref (var), NULL)))
#define _g_thread_unref0(var) ((var == NULL) ? NULL : (var = (g_thread_unref (var), NULL)))

struct _ServicesTagManager {
	GObject parent_instance;
	ServicesTagManagerPrivate * priv;
};

struct _ServicesTagManagerClass {
	GObjectClass parent_class;
};

struct _ServicesTagManagerPrivate {
	GstDiscoverer* discoverer;
	gchar* unknown;
	gint _discover_counter;
};

struct _Block3Data {
	int _ref_count_;
	ServicesTagManager* self;
	GstDiscovererInfo* info;
	GError* err;
};

struct _ObjectsTrack {
	GTypeInstance parent_instance;
	volatile int ref_count;
	ObjectsTrackPrivate * priv;
	gint id;
	gchar* path;
	gchar* title;
	gchar* artist;
	gchar* genre;
	gchar* album;
	guint64 duration;
};

struct _ObjectsTrackClass {
	GTypeClass parent_class;
	void (*finalize) (ObjectsTrack *self);
};


static gpointer services_tag_manager_parent_class = NULL;
extern ServicesDatabase* application_database;

GType services_tag_manager_get_type (void) G_GNUC_CONST;
#define SERVICES_TAG_MANAGER_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), SERVICES_TYPE_TAG_MANAGER, ServicesTagManagerPrivate))
ServicesTagManager* services_tag_manager_new (void);
ServicesTagManager* services_tag_manager_construct (GType object_type);
static void services_tag_manager_discovered (ServicesTagManager* self,
                                      GstDiscovererInfo* info,
                                      GError* err);
static Block3Data* block3_data_ref (Block3Data* _data3_);
static void block3_data_unref (void * _userdata_);
static void* __lambda16_ (Block3Data* _data3_);
const gchar* gst_pb_utils_discoverer_result_to_string (GstDiscovererResult self);
gpointer objects_track_ref (gpointer instance);
void objects_track_unref (gpointer instance);
GParamSpec* objects_param_spec_track (const gchar* name,
                                      const gchar* nick,
                                      const gchar* blurb,
                                      GType object_type,
                                      GParamFlags flags);
void objects_value_set_track (GValue* value,
                              gpointer v_object);
void objects_value_take_track (GValue* value,
                               gpointer v_object);
gpointer objects_value_get_track (const GValue* value);
GType objects_track_get_type (void) G_GNUC_CONST;
ObjectsTrack* objects_track_new (gint id,
                                 const gchar* path,
                                 const gchar* title,
                                 const gchar* artist,
                                 const gchar* genre,
                                 const gchar* album,
                                 guint64 duration);
ObjectsTrack* objects_track_construct (GType object_type,
                                       gint id,
                                       const gchar* path,
                                       const gchar* title,
                                       const gchar* artist,
                                       const gchar* genre,
                                       const gchar* album,
                                       guint64 duration);
GType services_database_get_type (void) G_GNUC_CONST;
void services_database_add_track (ServicesDatabase* self,
                                  ObjectsTrack* track);
gint services_tag_manager_get_discover_counter (ServicesTagManager* self);
static void services_tag_manager_set_discover_counter (ServicesTagManager* self,
                                                gint value);
static gpointer ___lambda16__gthread_func (gpointer self);
void services_tag_manager_add_discover_uri (ServicesTagManager* self,
                                            const gchar* uri);
static GObject * services_tag_manager_constructor (GType type,
                                            guint n_construct_properties,
                                            GObjectConstructParam * construct_properties);
static void _services_tag_manager_discovered_gst_discoverer_discovered (GstDiscoverer* _sender,
                                                                 GstDiscovererInfo* info,
                                                                 GError* err,
                                                                 gpointer self);
static void services_tag_manager_finalize (GObject * obj);
static void _vala_services_tag_manager_get_property (GObject * object,
                                              guint property_id,
                                              GValue * value,
                                              GParamSpec * pspec);
static void _vala_services_tag_manager_set_property (GObject * object,
                                              guint property_id,
                                              const GValue * value,
                                              GParamSpec * pspec);


ServicesTagManager*
services_tag_manager_construct (GType object_type)
{
	ServicesTagManager * self = NULL;
#line 7 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	self = (ServicesTagManager*) g_object_new (object_type, NULL);
#line 7 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	return self;
#line 179 "TagManager.c"
}


ServicesTagManager*
services_tag_manager_new (void)
{
#line 7 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	return services_tag_manager_construct (SERVICES_TYPE_TAG_MANAGER);
#line 188 "TagManager.c"
}


static gpointer
_g_object_ref0 (gpointer self)
{
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	return self ? g_object_ref (self) : NULL;
#line 197 "TagManager.c"
}


static gpointer
_g_error_copy0 (gpointer self)
{
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	return self ? g_error_copy (self) : NULL;
#line 206 "TagManager.c"
}


static Block3Data*
block3_data_ref (Block3Data* _data3_)
{
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	g_atomic_int_inc (&_data3_->_ref_count_);
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	return _data3_;
#line 217 "TagManager.c"
}


static void
block3_data_unref (void * _userdata_)
{
	Block3Data* _data3_;
	_data3_ = (Block3Data*) _userdata_;
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	if (g_atomic_int_dec_and_test (&_data3_->_ref_count_)) {
#line 228 "TagManager.c"
		ServicesTagManager* self;
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		self = _data3_->self;
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		_g_object_unref0 (_data3_->info);
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		_g_error_free0 (_data3_->err);
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		_g_object_unref0 (self);
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		g_slice_free (Block3Data, _data3_);
#line 240 "TagManager.c"
	}
}


static gpointer
_gst_tag_list_ref0 (gpointer self)
{
#line 28 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	return self ? gst_tag_list_ref (self) : NULL;
#line 250 "TagManager.c"
}


static gchar*
string_strip (const gchar* self)
{
	gchar* result = NULL;
	gchar* _result_ = NULL;
	gchar* _tmp0_;
	const gchar* _tmp1_;
#line 1304 "/usr/share/vala-0.40/vapi/glib-2.0.vapi"
	g_return_val_if_fail (self != NULL, NULL);
#line 1305 "/usr/share/vala-0.40/vapi/glib-2.0.vapi"
	_tmp0_ = g_strdup (self);
#line 1305 "/usr/share/vala-0.40/vapi/glib-2.0.vapi"
	_result_ = _tmp0_;
#line 1306 "/usr/share/vala-0.40/vapi/glib-2.0.vapi"
	_tmp1_ = _result_;
#line 1306 "/usr/share/vala-0.40/vapi/glib-2.0.vapi"
	g_strstrip (_tmp1_);
#line 1307 "/usr/share/vala-0.40/vapi/glib-2.0.vapi"
	result = _result_;
#line 1307 "/usr/share/vala-0.40/vapi/glib-2.0.vapi"
	return result;
#line 275 "TagManager.c"
}


static void*
__lambda16_ (Block3Data* _data3_)
{
	ServicesTagManager* self;
	void* result = NULL;
	gchar* uri = NULL;
	const gchar* _tmp0_;
	gchar* _tmp1_;
	gint _tmp63_;
	gint _tmp64_;
#line 20 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	self = _data3_->self;
#line 21 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_tmp0_ = gst_discoverer_info_get_uri (_data3_->info);
#line 21 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_tmp1_ = g_strdup (_tmp0_);
#line 21 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	uri = _tmp1_;
#line 23 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	if (gst_discoverer_info_get_result (_data3_->info) != GST_DISCOVERER_OK) {
#line 24 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		if (_data3_->err != NULL) {
#line 301 "TagManager.c"
			gint _tmp2_;
			const gchar* _tmp3_;
			GEnumValue* _tmp4_;
			const gchar* _tmp5_;
#line 25 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp2_ = _data3_->err->code;
#line 25 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp3_ = _data3_->err->message;
#line 25 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp4_ = g_enum_get_value (g_type_class_ref (gst_discoverer_result_get_type ()), gst_discoverer_info_get_result (_data3_->info));
#line 25 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp5_ = uri;
#line 25 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			g_warning ("TagManager.vala:25: DISCOVER ERROR: '%d' %s %s\n(%s)", _tmp2_, _tmp3_, (_tmp4_ != NULL) ? _tmp4_->value_name : NULL, _tmp5_);
#line 316 "TagManager.c"
		}
	} else {
		GstTagList* tags = NULL;
		GstTagList* _tmp6_;
		GstTagList* _tmp7_;
		GstTagList* _tmp8_;
#line 28 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		_tmp6_ = gst_discoverer_info_get_tags (_data3_->info);
#line 28 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		_tmp7_ = _gst_tag_list_ref0 (_tmp6_);
#line 28 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		tags = _tmp7_;
#line 30 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		_tmp8_ = tags;
#line 30 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		if (_tmp8_ != NULL) {
#line 333 "TagManager.c"
			guint64 duration = 0ULL;
			gchar* _title = NULL;
			gchar* _genre = NULL;
			gchar* _album = NULL;
			gchar* _artist = NULL;
			guint64 _duration = 0ULL;
			ObjectsTrack* track = NULL;
			ObjectsTrack* _tmp9_;
			ObjectsTrack* _tmp10_;
			guint64 _tmp11_;
			ObjectsTrack* _tmp12_;
			const gchar* _tmp13_;
			gchar* _tmp14_;
			GstTagList* _tmp15_;
			gchar* _tmp16_ = NULL;
			gboolean _tmp17_;
			ObjectsTrack* _tmp21_;
			const gchar* _tmp22_;
			gchar* _tmp23_;
			gchar* _tmp24_;
			gboolean _tmp25_;
			GstTagList* _tmp29_;
			gchar* _tmp30_ = NULL;
			gboolean _tmp31_;
			gboolean _tmp35_ = FALSE;
			ObjectsTrack* _tmp36_;
			guint64 _tmp37_;
			GstTagList* _tmp43_;
			gchar* _tmp44_ = NULL;
			gboolean _tmp45_;
			GstTagList* _tmp49_;
			gchar* _tmp50_ = NULL;
			gboolean _tmp51_;
			ServicesDatabase* _tmp61_;
			ObjectsTrack* _tmp62_;
#line 31 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			duration = (guint64) gst_discoverer_info_get_duration (_data3_->info);
#line 36 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_duration = (guint64) 0;
#line 39 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp9_ = objects_track_new (0, "", "", "", "", "", (guint64) 0);
#line 39 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			track = _tmp9_;
#line 40 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp10_ = track;
#line 40 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp11_ = duration;
#line 40 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp10_->duration = _tmp11_;
#line 41 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp12_ = track;
#line 41 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp13_ = uri;
#line 41 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp14_ = g_strdup (_tmp13_);
#line 41 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_g_free0 (_tmp12_->path);
#line 41 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp12_->path = _tmp14_;
#line 43 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp15_ = tags;
#line 43 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp17_ = gst_tag_list_get_string (_tmp15_, GST_TAG_TITLE, &_tmp16_);
#line 43 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_g_free0 (_title);
#line 43 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_title = _tmp16_;
#line 43 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			if (_tmp17_) {
#line 403 "TagManager.c"
				ObjectsTrack* _tmp18_;
				const gchar* _tmp19_;
				gchar* _tmp20_;
#line 44 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp18_ = track;
#line 44 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp19_ = _title;
#line 44 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp20_ = g_strdup (_tmp19_);
#line 44 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_g_free0 (_tmp18_->title);
#line 44 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp18_->title = _tmp20_;
#line 417 "TagManager.c"
			}
#line 47 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp21_ = track;
#line 47 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp22_ = _tmp21_->title;
#line 47 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp23_ = string_strip (_tmp22_);
#line 47 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp24_ = _tmp23_;
#line 47 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp25_ = g_strcmp0 (_tmp24_, "") == 0;
#line 47 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_g_free0 (_tmp24_);
#line 47 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			if (_tmp25_) {
#line 433 "TagManager.c"
				ObjectsTrack* _tmp26_;
				const gchar* _tmp27_;
				gchar* _tmp28_;
#line 48 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp26_ = track;
#line 48 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp27_ = uri;
#line 48 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp28_ = g_path_get_basename (_tmp27_);
#line 48 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_g_free0 (_tmp26_->title);
#line 48 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp26_->title = _tmp28_;
#line 447 "TagManager.c"
			}
#line 51 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp29_ = tags;
#line 51 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp31_ = gst_tag_list_get_string (_tmp29_, GST_TAG_GENRE, &_tmp30_);
#line 51 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_g_free0 (_genre);
#line 51 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_genre = _tmp30_;
#line 51 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			if (_tmp31_) {
#line 459 "TagManager.c"
				ObjectsTrack* _tmp32_;
				const gchar* _tmp33_;
				gchar* _tmp34_;
#line 52 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp32_ = track;
#line 52 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp33_ = _genre;
#line 52 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp34_ = g_strdup (_tmp33_);
#line 52 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_g_free0 (_tmp32_->genre);
#line 52 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp32_->genre = _tmp34_;
#line 473 "TagManager.c"
			}
#line 55 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp36_ = track;
#line 55 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp37_ = _tmp36_->duration;
#line 55 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			if (_tmp37_ == ((guint64) 0)) {
#line 481 "TagManager.c"
				GstTagList* _tmp38_;
				guint64 _tmp39_ = 0ULL;
				gboolean _tmp40_;
#line 55 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp38_ = tags;
#line 55 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp40_ = gst_tag_list_get_uint64 (_tmp38_, GST_TAG_DURATION, &_tmp39_);
#line 55 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_duration = _tmp39_;
#line 55 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp35_ = _tmp40_;
#line 493 "TagManager.c"
			} else {
#line 55 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp35_ = FALSE;
#line 497 "TagManager.c"
			}
#line 55 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			if (_tmp35_) {
#line 501 "TagManager.c"
				ObjectsTrack* _tmp41_;
				guint64 _tmp42_;
#line 56 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp41_ = track;
#line 56 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp42_ = _duration;
#line 56 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp41_->duration = _tmp42_;
#line 510 "TagManager.c"
			}
#line 59 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp43_ = tags;
#line 59 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp45_ = gst_tag_list_get_string (_tmp43_, GST_TAG_ALBUM, &_tmp44_);
#line 59 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_g_free0 (_album);
#line 59 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_album = _tmp44_;
#line 59 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			if (_tmp45_) {
#line 522 "TagManager.c"
				ObjectsTrack* _tmp46_;
				const gchar* _tmp47_;
				gchar* _tmp48_;
#line 60 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp46_ = track;
#line 60 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp47_ = _album;
#line 60 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp48_ = g_strdup (_tmp47_);
#line 60 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_g_free0 (_tmp46_->album);
#line 60 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp46_->album = _tmp48_;
#line 536 "TagManager.c"
			}
#line 63 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp49_ = tags;
#line 63 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp51_ = gst_tag_list_get_string (_tmp49_, GST_TAG_ALBUM_ARTIST, &_tmp50_);
#line 63 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_g_free0 (_artist);
#line 63 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_artist = _tmp50_;
#line 63 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			if (_tmp51_) {
#line 548 "TagManager.c"
				ObjectsTrack* _tmp52_;
				const gchar* _tmp53_;
				gchar* _tmp54_;
#line 64 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp52_ = track;
#line 64 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp53_ = _artist;
#line 64 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp54_ = g_strdup (_tmp53_);
#line 64 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_g_free0 (_tmp52_->artist);
#line 64 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp52_->artist = _tmp54_;
#line 562 "TagManager.c"
			} else {
				GstTagList* _tmp55_;
				gchar* _tmp56_ = NULL;
				gboolean _tmp57_;
#line 65 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp55_ = tags;
#line 65 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_tmp57_ = gst_tag_list_get_string (_tmp55_, GST_TAG_ARTIST, &_tmp56_);
#line 65 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_g_free0 (_artist);
#line 65 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				_artist = _tmp56_;
#line 65 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
				if (_tmp57_) {
#line 577 "TagManager.c"
					ObjectsTrack* _tmp58_;
					const gchar* _tmp59_;
					gchar* _tmp60_;
#line 66 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
					_tmp58_ = track;
#line 66 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
					_tmp59_ = _artist;
#line 66 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
					_tmp60_ = g_strdup (_tmp59_);
#line 66 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
					_g_free0 (_tmp58_->artist);
#line 66 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
					_tmp58_->artist = _tmp60_;
#line 591 "TagManager.c"
				}
			}
#line 69 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp61_ = application_database;
#line 69 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_tmp62_ = track;
#line 69 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			services_database_add_track (_tmp61_, _tmp62_);
#line 30 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_objects_track_unref0 (track);
#line 30 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_g_free0 (_artist);
#line 30 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_g_free0 (_album);
#line 30 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_g_free0 (_genre);
#line 30 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
			_g_free0 (_title);
#line 610 "TagManager.c"
		}
#line 23 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		_gst_tag_list_unref0 (tags);
#line 614 "TagManager.c"
	}
#line 73 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_tmp63_ = self->priv->_discover_counter;
#line 73 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	services_tag_manager_set_discover_counter (self, _tmp63_ - 1);
#line 74 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_tmp64_ = self->priv->_discover_counter;
#line 74 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	if (_tmp64_ == 0) {
#line 624 "TagManager.c"
	}
#line 78 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	g_object_run_dispose ((GObject*) _data3_->info);
#line 79 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	result = NULL;
#line 79 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_g_free0 (uri);
#line 79 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	return result;
#line 634 "TagManager.c"
}


static gpointer
___lambda16__gthread_func (gpointer self)
{
	gpointer result;
	result = __lambda16_ (self);
#line 20 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	block3_data_unref (self);
#line 20 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	return result;
#line 647 "TagManager.c"
}


static void
services_tag_manager_discovered (ServicesTagManager* self,
                                 GstDiscovererInfo* info,
                                 GError* err)
{
	Block3Data* _data3_;
	GstDiscovererInfo* _tmp0_;
	GError* _tmp1_;
	GThread* _tmp2_;
	GThread* _tmp3_;
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	g_return_if_fail (self != NULL);
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	g_return_if_fail (info != NULL);
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_data3_ = g_slice_new0 (Block3Data);
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_data3_->_ref_count_ = 1;
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_data3_->self = g_object_ref (self);
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_tmp0_ = _g_object_ref0 (info);
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_g_object_unref0 (_data3_->info);
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_data3_->info = _tmp0_;
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_tmp1_ = _g_error_copy0 (err);
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_g_error_free0 (_data3_->err);
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_data3_->err = _tmp1_;
#line 20 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_tmp2_ = g_thread_new (NULL, ___lambda16__gthread_func, block3_data_ref (_data3_));
#line 20 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_tmp3_ = _tmp2_;
#line 20 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_g_thread_unref0 (_tmp3_);
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	block3_data_unref (_data3_);
#line 19 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_data3_ = NULL;
#line 693 "TagManager.c"
}


void
services_tag_manager_add_discover_uri (ServicesTagManager* self,
                                       const gchar* uri)
{
	gint _tmp0_;
	gint _tmp1_;
	GstDiscoverer* _tmp2_;
#line 83 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	g_return_if_fail (self != NULL);
#line 83 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	g_return_if_fail (uri != NULL);
#line 84 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_tmp0_ = self->priv->_discover_counter;
#line 84 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	if (_tmp0_ == 0) {
#line 712 "TagManager.c"
	}
#line 88 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_tmp1_ = self->priv->_discover_counter;
#line 88 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	services_tag_manager_set_discover_counter (self, _tmp1_ + 1);
#line 89 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_tmp2_ = self->priv->discoverer;
#line 89 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	gst_discoverer_discover_uri_async (_tmp2_, uri);
#line 722 "TagManager.c"
}


gint
services_tag_manager_get_discover_counter (ServicesTagManager* self)
{
	gint result;
	gint _tmp0_;
#line 5 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	g_return_val_if_fail (self != NULL, 0);
#line 5 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_tmp0_ = self->priv->_discover_counter;
#line 5 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	result = _tmp0_;
#line 5 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	return result;
#line 739 "TagManager.c"
}


static void
services_tag_manager_set_discover_counter (ServicesTagManager* self,
                                           gint value)
{
#line 5 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	g_return_if_fail (self != NULL);
#line 5 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	if (services_tag_manager_get_discover_counter (self) != value) {
#line 5 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		self->priv->_discover_counter = value;
#line 5 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		g_object_notify_by_pspec ((GObject *) self, services_tag_manager_properties[SERVICES_TAG_MANAGER_DISCOVER_COUNTER_PROPERTY]);
#line 755 "TagManager.c"
	}
}


static void
_services_tag_manager_discovered_gst_discoverer_discovered (GstDiscoverer* _sender,
                                                            GstDiscovererInfo* info,
                                                            GError* err,
                                                            gpointer self)
{
#line 13 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	services_tag_manager_discovered ((ServicesTagManager*) self, info, err);
#line 768 "TagManager.c"
}


static GObject *
services_tag_manager_constructor (GType type,
                                  guint n_construct_properties,
                                  GObjectConstructParam * construct_properties)
{
	GObject * obj;
	GObjectClass * parent_class;
	ServicesTagManager * self;
	GError * _inner_error_ = NULL;
#line 9 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	parent_class = G_OBJECT_CLASS (services_tag_manager_parent_class);
#line 9 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	obj = parent_class->constructor (type, n_construct_properties, construct_properties);
#line 9 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, SERVICES_TYPE_TAG_MANAGER, ServicesTagManager);
#line 787 "TagManager.c"
	{
		GstDiscoverer* _tmp0_ = NULL;
		GstDiscoverer* _tmp1_;
		GstDiscoverer* _tmp2_;
		GstDiscoverer* _tmp3_;
		GstDiscoverer* _tmp4_;
#line 11 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		_tmp1_ = gst_discoverer_new ((GstClockTime) (5 * GST_SECOND), &_inner_error_);
#line 11 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		_tmp0_ = _tmp1_;
#line 11 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		if (G_UNLIKELY (_inner_error_ != NULL)) {
#line 800 "TagManager.c"
			goto __catch2_g_error;
		}
#line 11 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		_tmp2_ = _tmp0_;
#line 11 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		_tmp0_ = NULL;
#line 11 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		_g_object_unref0 (self->priv->discoverer);
#line 11 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		self->priv->discoverer = _tmp2_;
#line 12 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		_tmp3_ = self->priv->discoverer;
#line 12 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		gst_discoverer_start (_tmp3_);
#line 13 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		_tmp4_ = self->priv->discoverer;
#line 13 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		g_signal_connect_object (_tmp4_, "discovered", (GCallback) _services_tag_manager_discovered_gst_discoverer_discovered, self, 0);
#line 10 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		_g_object_unref0 (_tmp0_);
#line 821 "TagManager.c"
	}
	goto __finally2;
	__catch2_g_error:
	{
		GError* err = NULL;
		GError* _tmp5_;
		const gchar* _tmp6_;
#line 10 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		err = _inner_error_;
#line 10 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		_inner_error_ = NULL;
#line 15 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		_tmp5_ = err;
#line 15 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		_tmp6_ = _tmp5_->message;
#line 15 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		g_warning ("TagManager.vala:15: %s", _tmp6_);
#line 10 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		_g_error_free0 (err);
#line 841 "TagManager.c"
	}
	__finally2:
#line 10 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	if (G_UNLIKELY (_inner_error_ != NULL)) {
#line 10 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
#line 10 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		g_clear_error (&_inner_error_);
#line 850 "TagManager.c"
	}
#line 9 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	return obj;
#line 854 "TagManager.c"
}


static void
services_tag_manager_class_init (ServicesTagManagerClass * klass)
{
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	services_tag_manager_parent_class = g_type_class_peek_parent (klass);
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	g_type_class_add_private (klass, sizeof (ServicesTagManagerPrivate));
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	G_OBJECT_CLASS (klass)->get_property = _vala_services_tag_manager_get_property;
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	G_OBJECT_CLASS (klass)->set_property = _vala_services_tag_manager_set_property;
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	G_OBJECT_CLASS (klass)->constructor = services_tag_manager_constructor;
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	G_OBJECT_CLASS (klass)->finalize = services_tag_manager_finalize;
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	g_object_class_install_property (G_OBJECT_CLASS (klass), SERVICES_TAG_MANAGER_DISCOVER_COUNTER_PROPERTY, services_tag_manager_properties[SERVICES_TAG_MANAGER_DISCOVER_COUNTER_PROPERTY] = g_param_spec_int ("discover-counter", "discover-counter", "discover-counter", G_MININT, G_MAXINT, 0, G_PARAM_STATIC_STRINGS | G_PARAM_READABLE));
#line 875 "TagManager.c"
}


static void
services_tag_manager_instance_init (ServicesTagManager * self)
{
	gchar* _tmp0_;
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	self->priv = SERVICES_TAG_MANAGER_GET_PRIVATE (self);
#line 4 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_tmp0_ = g_strdup (_ ("Unknown"));
#line 4 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	self->priv->unknown = _tmp0_;
#line 5 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	self->priv->_discover_counter = 0;
#line 891 "TagManager.c"
}


static void
services_tag_manager_finalize (GObject * obj)
{
	ServicesTagManager * self;
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, SERVICES_TYPE_TAG_MANAGER, ServicesTagManager);
#line 2 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_g_object_unref0 (self->priv->discoverer);
#line 4 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	_g_free0 (self->priv->unknown);
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	G_OBJECT_CLASS (services_tag_manager_parent_class)->finalize (obj);
#line 907 "TagManager.c"
}


GType
services_tag_manager_get_type (void)
{
	static volatile gsize services_tag_manager_type_id__volatile = 0;
	if (g_once_init_enter (&services_tag_manager_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (ServicesTagManagerClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) services_tag_manager_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (ServicesTagManager), 0, (GInstanceInitFunc) services_tag_manager_instance_init, NULL };
		GType services_tag_manager_type_id;
		services_tag_manager_type_id = g_type_register_static (G_TYPE_OBJECT, "ServicesTagManager", &g_define_type_info, 0);
		g_once_init_leave (&services_tag_manager_type_id__volatile, services_tag_manager_type_id);
	}
	return services_tag_manager_type_id__volatile;
}


static void
_vala_services_tag_manager_get_property (GObject * object,
                                         guint property_id,
                                         GValue * value,
                                         GParamSpec * pspec)
{
	ServicesTagManager * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, SERVICES_TYPE_TAG_MANAGER, ServicesTagManager);
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	switch (property_id) {
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		case SERVICES_TAG_MANAGER_DISCOVER_COUNTER_PROPERTY:
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		g_value_set_int (value, services_tag_manager_get_discover_counter (self));
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		break;
#line 941 "TagManager.c"
		default:
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		break;
#line 947 "TagManager.c"
	}
}


static void
_vala_services_tag_manager_set_property (GObject * object,
                                         guint property_id,
                                         const GValue * value,
                                         GParamSpec * pspec)
{
	ServicesTagManager * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, SERVICES_TYPE_TAG_MANAGER, ServicesTagManager);
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
	switch (property_id) {
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		case SERVICES_TAG_MANAGER_DISCOVER_COUNTER_PROPERTY:
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		services_tag_manager_set_discover_counter (self, g_value_get_int (value));
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		break;
#line 968 "TagManager.c"
		default:
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
#line 1 "/home/alain/Proyectos/byte/src/Services/TagManager.vala"
		break;
#line 974 "TagManager.c"
	}
}



